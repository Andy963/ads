# 自动需求建档功能需求说明

## 1. 文档概览
- 版本：v0.1
- 状态：Draft
- 作者：ADS 开发小组
- 目标发布日期：待定

## 2. 背景与问题
- 当前 CLI 仅在用户主动运行 `/ads.new` 时才创建工作流与 spec。
- 当用户直接输入自然语言需求时，系统无法自动建档，易导致需求缺失、追溯困难。
- 手动追问与记录依赖个人习惯，缺乏统一流程与持久化状态。

## 3. 目标
1. 在无活动工作流的对话中，自动识别是否为任务需求。
2. 对任务需求自动创建统一工作流与 `docs/specs/...`，并引导需求澄清。
3. 在需求信息补齐前持续追问，补齐后写入 `requirement.md` 并提示进入后续阶段。
4. 若用户仅聊天下命令或信息不足，保持现有交互，不误触发建档。

## 4. 非目标
- 不改动已存在的工作流流程（当上下文已绑定工作流时维持现有逻辑）。
- 不实现设计/实施阶段的自动化填充（仅生成骨架）。
- 不实现 cancel 功能或 UI 端扩展。

## 5. 用户价值
- 开发者在自然对话中即可启动完整 spec 建档流程，提高规范性。
- 避免遗漏需求字段，实现需求—设计—实施链路追踪。
- 方便后续审查、交接与追责，减少人工文档维护成本。

## 6. 成功指标
- 任务需求识别准确率 ≥ 90%。
- 自动建档流程满足 ≥ 80% 的自然输入场景。
- 需求澄清完成后 `requirement.md` 填写完整度 ≥ 95%。

## 7. 依赖与约束
- 依赖 Codex API 提供输入分类与对话能力。
- 需与现有 workflow/template 体系兼容，不能破坏 `/ads.*` 命令。
- CLI 必须能够持久化澄清状态，以支持中断恢复。

## 8. 风险
- 误判导致错误创建工作流 → 需要提供取消/删除入口。
- 长流程可能打断用户与 Codex 的即时互动 → 需要清晰提示当前处于需求收集阶段。
- 持久化状态可能在异常退出时残留 → 需设计恢复与清理机制。
